# vue3.0 特性

## 响应式

2.x 的响应式是基于 Object.defineProperty 实现的代理，兼容主流浏览器和 ie9 以上的 ie 浏览器，能够监听数据对象的变化，但是监听不到对象属性的增删、数组元素和长度的变化，同时会在 vue 初始化的时候把所有的 Observer 都建立好，才能观察到数据对象属性的变化。

针对上面的问题，3.0 进行了革命性的变更，采用了 ES2015 的 Proxy 来代替 Object.defineProperty，可以做到监听对象属性的增删和数组元素和长度的修改，还可以监听 Map、Set、WeakSet、WeakMap，同时还实现了惰性的监听，不会在初始化的时候创建所有的 Observer，而是会在用到的时候才去监听。但是，虽然主流的浏览器都支持 Proxy，ie 系列却还是不兼容，所以针对 ie11，vue3.0 决定做单独的适配，暴露出来的 api 一样，但是底层实现还是 Object.defineProperty，这样导致了 ie11 还是有 2.x 的问题。但是绝大部分情况下，3.0 带来的好处已经能够体验到了。

响应式方面，vue3.0 做了实现机制的变更，采用 ES2015 的 Proxy，不但解决了 vue2.x 中的问题，还是得性能有了进一步提升。虽然有一些兼容问题，但是通过适配的方式解决掉了。此外，还暴露了 observable 的 api 来创建响应式对象，可以替代掉 event bus，来做一些跨组件的通信。

## 模板

模板方面没有大的变更，只改了作用域插槽，2.x 的机制导致作用域插槽变了，父组件会重新渲染，而 3.0 把作用于插槽改成了函数的方式，这样只会影响子组件的重新渲染，提升了渲染的性能。

同时，对于 render 函数的方面，vue3.0 也会进行一系列更改来方便习惯直接使用 api 来生成 vdom 的开发者。

## 对象式的组件声明方式

vue2.x 中的组件是通过声明的方式传入一系列 option，和 TypeScript 的结合需要通过一些装饰器的方式来做，虽然能实现功能，但是比较麻烦。

3.0 修改了组件的声明方式，改成了类式的写法，这样使得和 TypeScript 的结合变得很容易。

此外，vue 的源码也改用了 TypeScript 来写。其实当代码的功能复杂之后，必须有一个静态类型系统来做一些辅助管理，如 React 使用的 Flow，Angular 使用的 TypeScript。现在 vue3.0 也全面改用 TypeScript 来重写了，更是使得对外暴露的 api 更容易结合 TypeScript。静态类型系统对于复杂代码的维护确实很有必要。

## 其他的一些东西

vue3.0 的改变是全面的，上面只涉及到主要的 3 个方面，还有一些其他的更改：

- 支持自定义渲染器，从而使得 weex 可以通过自定义渲染器的方式来扩展，而不是直接 fork 源码来改的方式。
- 支持 Fragment（多个根节点）和 Protal（在 dom 其他部分渲染组建内容）组件，针对一些特殊的场景做了处理。
- 基于 treeshaking 优化，提供了更多的内置功能。

## 参考

[作者:凌霄光](https://zhuanlan.zhihu.com/p/46269528)>)
